# 🎉ウィスパーノート

* 音声ファイルをEXOファイルに変換します。
* 音声はテキストオブジェクトに変換されます。

## ⚠注意点

* **※使用するモデルにもよりますが、大体10GB以上のストレージ容量が必要になります。**
* **※右下のコマンドプロンプトでスクロール以外の操作はしないでください。アプリがフリーズしてしまいます。**
* **※文字起こし中にアプリを終了しないでください。終了してもサブプロセスが処理を続けたまま残ってしまいます。**
* **※WAVフォルダに既存のフォルダを指定する場合は注意してください。フォルダ内の既存のWAVファイルがすべて削除されてしまいます。**

## ⬇️ダウンロード

* [最新バージョンはこちら](https://github.com/hebiiro/whisper_note/releases/latest/)

## 🚀導入方法

1. 任意のフォルダに`whisper_note.exe`を配置します。

## ✏️用語

* `ステム(stem)` ✏️拡張子を除くファイル名のことです。
* `VAD(Voice Activity Detection)` ✏️アクティブな音声を検出することを意味します。
* `ダイアライズ(diarize)` ✏️話し手を判別することを意味します。
* `セグメント(segment)` ✏️英語系の場合は単語の集まりを意味します。日本語だと大体一文になります。
* `トークン(token)` ✏️英語系の場合は単語を意味します。日本語だと単語ではなく一文字になることが多いです。

## 💡使い方

1. `whisper_note.exe`を実行します。
1. `音声ファイル`で音声ファイルを指定します。
1. `実行`ボタンを押します。
	1. 初回は`Faster-Whisper-XXL`の導入が始まります。
	1. 自動的に`Faster-Whisper-XXL`がダウンロードされます。**※非常に時間がかかります。約1.5GBのストレージ容量が必要です。**
	1. 自動的に`Faster-Whisper-XXL`が展開されます。**※非常に時間がかかります。約4.5GBのストレージ容量が必要です。**
	1. `usage-faster-whisper-xxl.txt`が作成されて表示されます。Faster-Whisper-XXLの詳細なオプションはこのファイルを参照してください。
	1. **※導入が完了したらもう一度`実行`ボタンを押してください。**
1. `音声ファイルのステム.faster-whisper/出力サブフォルダ名/音声ファイルのステム.json`ファイルが作成されます。
1. `AviUtl用出力`または`PSDToolKit用出力`ボタンを押します。
1. `音声ファイルのステム.exo`ファイルが作成されます。
1. 作成したEXOファイルをAviUtlでインポートします。
	* **※PSDToolKitの環境設定の`1フレーム目に音声とテキストがある*.exoをドロップした時`が発動しないように注意してください。**

## 📝Faster-Whisper-XXLの設定

* `実行` ✏️音声ファイルを文字起こししてJSONファイルを作成します。
	* **※初回はモデルのダウンロードに時間がかかります。モデルの大きさに応じたストレージ容量も必要です。**
* `音声ファイル` ✏️文字起こし対象の音声ファイル(もしくは動画ファイル)を指定します。
* `タスク` ✏️文字起こしと同時に翻訳するかどうかを指定します。デフォルトは`指定なし`です。
	* `指定なし` ✏️`--task`オプションを指定しません。この場合`transcribe`として動作します。
	* `transcribe` ✏️文字起こしします。
	* `translate` ✏️文字起こしと同時に英語に翻訳します。
* `言語` ✏️`--language`オプションを指定します。デフォルトは`ja`(日本語)です。
	* `指定なし` ✏️最初の30秒間から自動的に言語を判別します。
* `モデル` ✏️`--model`オプションを指定します。デフォルトは`large-v2`です。
	* `指定なし` ✏️`--model`オプションを指定しません。この場合エラーになります。
	* `large-v2` ✏️最も精度が高いです。**※約3GBのストレージ容量が必要です。**
	* `large-v3` ✏️`large-v2`より精度が低いです。ただし、特定状況下では`large-v2`より精度が高い場合もあります。
	* `その他` ✏️`large-v2`より精度が低いです。通常は使用しません。
* `ダイアライズ` ✏️`--diarize`オプションを指定します。デフォルトは`pyannote_v3.1`です。
	* `指定なし` ✏️`--diarize`オプションを指定しません。この場合`--sentence`なども省略されます。
	* `pyannote_v3.0` ✏️CPUでダイアライズを実行します。
	* `pyannote_v3.1` ✏️GPU(CUDA)でダイアライズを実行します。
	* `reverb_v1` ✏️文字起こしの研究用です。通常用途では使用できません。それに`pyannote`の方が精度が高いです。
	* `reverb_v2` ✏️文字起こしの研究用です。通常用途では使用できません。それに`pyannote`の方が精度が高いです。
* `VADメソッド` ✏️`--vad_method`オプションを指定します。デフォルトは`pyannote_v3`です。
	* `指定なし` ✏️`--vad_method`オプションを指定しません。この場合`silero_v4_fw`が使用されます。
	* `silero_v3` ✏️`silero_v4`より精度が低いです。
	* `silero_v4` ✏️`pyannote_v3`より精度が低いです。
	* `silero_v5` ✏️`silero_v4`より精度が低いです。
	* `silero_v4_fw` ✏️`silero_v4`とほぼ同じです。
	* `silero_v5_fw` ✏️`silero_v5`とほぼ同じです。
	* `pyannote_v3` ✏️最も精度が高いです。
	* `pyannote_v3_onnx` ✏️`pyannote_v3`の軽量版です。若干精度が低いです。
	* `webrtc` ✏️古いVADです。精度が低いです。通常は使用しません。
	* `auditok` ✏️`VAD`ではなく`AAD(Audio Activity Detection)`です。通常は使用しません。
* `フィルタ` ✏️ffmpegを使用した音声フィルタを指定します。音声にノイズがない限り通常は使用しません。デフォルトは`指定なし`です。
	* `指定なし` ✏️音声フィルタを使用しません。
	* `ff_mdx_kim2` ✏️楽曲のボーカルを抽出するフィルタだと思われます。
	* `その他` ✏️通常は使用しません。複数のフィルタを使用したい場合は`追加コマンド`で指定してください。
* `日本語モード` ✏️`--japanese`オプションを指定します。デフォルトは`blend`です。
	* `指定なし` ✏️`--japanese`オプションを指定しません。`blend`と同じように動作すると思われます。
	* `kanji` ✏️トークンの中から漢字が優先して選択されます。
	* `hiragana` ✏️トークンの中からひらがなが優先して選択されます。
	* `katakana` ✏️トークンの中からカタカナが優先して選択されます。
* `VADパディング` ✏️`--vad_speech_pad_ms`オプションの値を指定します。デフォルトは`(空)`です。
	* `(空)` ✏️`--vad_speech_pad_ms`オプションを指定しません。`900`を指定した場合と同じように動作すると思われます。
	* `数値` ✏️セグメント前後の余白をミリ秒単位で指定します。なるべく余白をなくしたい場合は0を指定します。

## 📝EXOファイルの設定

* この中で意味がある設定は`映像`の`FPS`だけだと思われます。

* `映像` ✏️映像の設定です。
	* `サイズ` ✏️映像サイズを指定します。
	* `FPS` ✏️映像レートの分子と分母を指定します。フレーム番号に影響するので、通常はAviUtlのプロジェクトと同じ値を指定します。
* `音声` ✏️音声の設定です。
	* `レート` ✏️音声レートを指定します。
	* `チャンネル` ✏️音声チャンネル数を指定します。

## 📝AviUtl用の設定

* `AviUtl用出力` ✏️JSONファイルを読み込んでEXOファイルを出力します。
	* 右クリックするとコンテキストメニューが表示されます。
	* `出力時にファイルを選択` ✏️チェックを入れると出力するEXOファイルを選択できます。チェックを入れていない場合は`音声ファイルのステム.exo`が出力されます。
* `JSONファイル` ✏️文字起こしで出力されたJSONファイルを指定します。自動的に指定されますが、手動で指定することもできます。
* `分割モード` ✏️テキストオブジェクトを配置する粒度を指定します。
	* `セグメント毎` ✏️約一文毎にテキストオブジェクトを配置します。
	* `トークン毎` ✏️約一文字毎にテキストオブジェクトを配置します。
	* `両方` ✏️`セグメント毎`と`トークン毎`の両方のテキストオブジェクトを配置します。
* `レイヤーオフセット` ✏️レイヤーをずらさないと配置できない場合の追加オフセットを指定します。通常は0です。
* `開始位置マージン`
* `終了位置マージン`
	* ✏️セグメントのマージンを秒単位で指定します。`VADパディング`で制御できない場合に使用します。通常は0.0です。

## 📝PSDToolKit用の設定

* `PSDToolKit用出力` ✏️PSDToolKit用のEXOファイルとWAVファイルを出力します。
* `WAVフォルダ` ✏️WAVファイルを出力するフォルダを指定します。自動的に`音声ファイルのステム`フォルダに指定されますが、手動で指定することもできます。
* `「口パク準備」を生成` ✏️チェックが入っている場合は口パク準備オブジェクトを配置します。
* `「多目的スライダー」を生成` ✏️チェックが入っている場合は多目的スライダーオブジェクトを配置します。
* `「字幕準備」を生成` ✏️チェックが入っている場合は字幕準備オブジェクトを配置します。
* `スライダー個数` ✏️多目的スライダーの個数を指定します。
* `すべての準備オブジェクトを単一のオブジェクトへ統合` ✏️チェックが入っている場合は準備オブジェクトを一括化して配置します。

## 🔖更新履歴

* r1 - 2025/03/21 🚀初版

## ⚗️テスト環境

* Win11 Home 24H2

## 💳クレジット

* JSON for Modern C++ https://github.com/nlohmann/json
* Standalone Faster-Whisper-XXL https://github.com/Purfview/whisper-standalone-win
* 7-Zip Extra https://7-zip.opensource.jp/

### 🗣️サンプル音声のクレジット

* 無料AIトークソフトCOEIROINK: https://coeiroink.com
* COEIROINK https://commons.nicovideo.jp/works/nc257937
* COEIROINK:つへのい https://commons.nicovideo.jp/works/nc319289
* COEIROINK:つくよみちゃん https://commons.nicovideo.jp/works/nc250184

## 👽️作成者情報

* 作成者 - 蛇色 (へびいろ)
* GitHub - https://github.com/hebiiro
* Twitter - https://x.com/io_hebiiro

## 🚨免責事項

この作成物および同梱物を使用したことによって生じたすべての障害・損害・不具合等に関しては、私と私の関係者および私の所属するいかなる団体・組織とも、一切の責任を負いません。各自の責任においてご使用ください。
